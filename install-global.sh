#!/bin/bash

# Install global test script for Claude Worker
# This allows you to run 'test-claude-worker' from anywhere

SCRIPT_NAME="test-claude-worker"
INSTALL_DIR="$HOME/.local/bin"
CURRENT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

echo "🔧 Installing global Claude Worker test script..."

# Create install directory if it doesn't exist
mkdir -p "$INSTALL_DIR"

# Create the global script
cat > "$INSTALL_DIR/$SCRIPT_NAME" << EOF
#!/bin/bash
# Global Claude Worker Test Script
# Auto-generated by install-global.sh

# Change to the worker directory and run the test
cd "$CURRENT_DIR" && ./test-worker.sh "\$@"
EOF

# Make it executable
chmod +x "$INSTALL_DIR/$SCRIPT_NAME"

# Check if ~/.local/bin is in PATH
if [[ ":$PATH:" != *":$HOME/.local/bin:"* ]]; then
    echo ""
    echo "⚠️  $HOME/.local/bin is not in your PATH."
    echo "Add this line to your ~/.zshrc or ~/.bashrc:"
    echo ""
    echo "export PATH=\"\$HOME/.local/bin:\$PATH\""
    echo ""
    echo "Then run: source ~/.zshrc"
    echo ""
else
    echo "✅ Global script installed successfully!"
    echo ""
    echo "🚀 You can now run 'test-claude-worker' from anywhere!"
    echo ""
fi

echo "📍 Script installed at: $INSTALL_DIR/$SCRIPT_NAME"
echo "📁 Worker directory: $CURRENT_DIR"